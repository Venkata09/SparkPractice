package concepts

import org.apache.spark.sql.SparkSession

/**
  * Created by vdokku on 2/22/2018.
  */
object SparkZipWithIndex_AnotherExample_More {


  def main(args: Array[String]): Unit = {


    val sparkSession = SparkSession.builder().appName("DataFrame VS DataSet").master("local[4]")
      .appName("<<<< GroupByExample  >>>>>")
      .getOrCreate()

    val sc = sparkSession.sparkContext


    val sample_data = Seq(((3, 4), 5, 5, 5), ((3, 4), 5, 5, 9), ((3, 4), 7, 5, 5), ((1, 2), 1, 2, 3), ((1, 2), 1, 4, 7), ((1, 2), 2, 2, 3))
    val temp1 = sc.parallelize(sample_data)


    println("+++++++++++++++++++++++++++111111111111+++++++++++++++++")

    temp1.map((_, 1)).foreach(println)
    /*

        ((((1,2),1,2,3),1),0)
        ((((1,2),1,4,7),1),1)
        ((((1,2),2,2,3),1),2)
        ((((3,4),5,5,5),1),3)
        ((((3,4),5,5,9),1),4)
        ((((3,4),7,5,5),1),5)*/
    println("+++++++++++++++++++++++++++111111111111+++++++++++++++++")

    println("+++++++++++++++++++++++++++2222222222+++++++++++++++++")

    temp1.map(entry => (entry, 1)).foreach(println)


    /*
    (((1,2),1,4,7),1)
(((3,4),5,5,5),1)
(((1,2),1,2,3),1)
(((3,4),5,5,9),1)
(((1,2),2,2,3),1)
(((3,4),7,5,5),1)

(((3,4),5,5,9),1)
(((1,2),1,2,3),1)
(((1,2),1,4,7),1)
                          (((3,4),5,5,5),1)
(((1,2),2,2,3),1)
(((3,4),7,5,5),1)



(((1,2),1,4,7),1)
(((1,2),2,2,3),1)
                          (((3,4),5,5,5),1)
(((1,2),1,2,3),1)
(((3,4),5,5,9),1)
(((3,4),7,5,5),1)
     */
    println("+++++++++++++++++++++++++++2222222222+++++++++++++++++")


    println("+++++++++++++++++++++++++++LAST+++++++++++++++++")

    temp1.map(x => (x, 1)).sortByKey().zipWithIndex.collect().foreach(println)
    // ZIP with INDEX always start with 0.................



    println("+++++++++++++++++++++++++++LAST+++++++++++++++++")


    /*((((1,2),1,2,3),1),0)
      ((((1,2),1,4,7),1),1)
      ((((1,2),2,2,3),1),2)
      ((((3,4),5,5,5),1),3)
      ((((3,4),5,5,9),1),4)
      ((((3,4),7,5,5),1),5)
      +++++++++++++++++++++++++++LAST+++++++++++++++++*/

  }

}
